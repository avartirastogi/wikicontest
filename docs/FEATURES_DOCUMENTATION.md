# WikiContest Platform - Complete Features Documentation

This document provides a comprehensive overview of all features present in the WikiContest community event management platform. This documentation was generated by scanning the entire codebase, including backend models, routes, frontend components, and configuration files.

---

## Table of Contents

1. [Authentication & User Management](#authentication--user-management)
2. [User Management & Profiles](#user-management--profiles)
3. [Contest Management](#contest-management)
4. [Submission System](#submission-system)
5. [Review & Scoring System](#review--scoring-system)
6. [Trusted Members System](#trusted-members-system)
7. [Contest Requests System](#contest-requests-system)
8. [Leaderboards & Statistics](#leaderboards--statistics)
9. [MediaWiki Integration](#mediawiki-integration)
10. [Frontend Features](#frontend-features)
11. [Security & Permissions](#security--permissions)
12. [Database & Data Models](#database--data-models)

---

## Authentication & User Management

### Email/Password Authentication
- **User Registration**: Users can register with username, email, and password
  - Username validation: 3-20 characters, alphanumeric and underscores only
  - Email validation: Standard email format validation
  - Password requirements: Minimum 6 characters
  - Automatic password hashing using bcrypt
  - Duplicate username/email prevention

- **User Login**: Traditional email/password authentication
  - JWT token generation upon successful login
  - HTTP-only cookie storage for security
  - CSRF protection enabled
  - Session management

- **User Logout**: Secure logout functionality
  - Clears JWT tokens
  - Clears OAuth session data
  - Removes authentication cookies

### Wikimedia OAuth 1.0a Authentication
- **OAuth Login Flow**: Complete OAuth 1.0a implementation
  - Initiates OAuth flow with Wikimedia
  - Request token generation and storage
  - User authorization redirect to Wikimedia
  - Access token exchange
  - User identity retrieval from Wikimedia API
  - Automatic user creation for new OAuth users
  - OAuth token storage for MediaWiki API access

- **OAuth Configuration**: Flexible OAuth setup
  - Configurable callback URLs
  - Support for out-of-band (OOB) verification
  - Session and cache-based token storage
  - Cross-port cookie support for development

### User Roles & Permissions
- **Role Hierarchy**:
  - **User**: Default role, can submit articles and participate
  - **Admin**: Can manage contests, review submissions, view all data
  - **Superadmin**: Highest privilege level, can manage trusted members and contest requests

- **Role-Based Access Control**:
  - Middleware-based permission checks
  - Contextual permissions (contest creator, jury member, organizer)
  - Automatic permission inheritance for superadmins

---

## User Management & Profiles

### User Profiles
- **Profile Viewing**: Users can view their own profile
  - Username, email, role display
  - Total score display
  - Trusted member status
  - Account creation date

- **Profile Editing**: Users can update their profile
  - Username modification (with uniqueness validation)
  - Email modification (with format and uniqueness validation)
  - Real-time validation feedback

### User Dashboard
- **Statistics Overview**:
  - Total accumulated score across all contests
  - Number of contests created
  - Number of contests where user is a jury member
  - Contest-wise score breakdown

- **Recent Submissions**:
  - List of all submissions grouped by contest
  - Submission status (pending, accepted, rejected)
  - Quick access to submission details
  - Review feedback viewing

- **Created Contests**:
  - List of all contests created by the user
  - Contest status display
  - Submission count per contest
  - Quick navigation to contest details

- **Jury Memberships**:
  - List of contests where user serves as jury member
  - Quick access to jury dashboard

### User Search & Lookup
- **User Search**: Autocomplete functionality for finding users
  - Search by username (minimum 2 characters)
  - Configurable result limit (default: 10)
  - Case-insensitive search

- **User Lookup**: Get username by user ID
  - Minimal endpoint for non-sensitive user information
  - Used for displaying usernames in various contexts

---

## Contest Management

### Contest Creation
- **Contest Creation (Trusted Members/Superadmins)**:
  - Full contest configuration form
  - Contest name and project name
  - Description and rules (JSON format)
  - Start and end dates
  - Jury members assignment (comma-separated usernames)
  - Organizers assignment (comma-separated usernames)
  - Scoring system configuration (simple or multi-parameter)
  - Article requirements (byte count, reference count)
  - Category requirements (JSON array of category URLs)
  - Template link for automatic template enforcement
  - Submission type restrictions (new articles, expansions, or both)

- **Contest Request System** (for non-privileged users):
  - Users can submit contest creation requests
  - Superadmins review and approve/reject requests
  - Request status tracking (pending, approved, rejected)
  - Rejection reason tracking

### Contest Configuration
- **Basic Information**:
  - Contest name (unique identifier)
  - Project name (e.g., Wikimedia, Wikipedia)
  - Description (rich text support)
  - Start and end dates
  - Creation timestamp

- **Scoring Systems**:
  - **Simple Scoring**: Fixed points for accepted/rejected submissions
    - Configurable accepted submission points
    - Configurable rejected submission points
  - **Multi-Parameter Scoring**: Weighted scoring system
    - Customizable parameters (e.g., Quality, Sources, Neutrality, Formatting)
    - Individual parameter weights (must sum to 100%)
    - Score range configuration (min/max)
    - Parameter descriptions
    - Automatic weighted score calculation

- **Article Requirements**:
  - Minimum byte count requirement
  - Minimum reference count requirement (footnotes and external links)
  - Category requirements (articles must belong to at least one specified category)
  - Submission type restrictions:
    - New articles only
    - Expansions only
    - Both allowed

- **People Management**:
  - **Jury Members**: Users who can review submissions
    - Comma-separated username list
    - Jury members can review all submissions in their assigned contests
  - **Organizers**: Users who can manage the contest
    - Comma-separated username list
    - Creator is automatically included as organizer
    - Organizers can edit contest, view submissions, manage settings
    - Organizer management (add/remove) with validation

- **Template & Category Enforcement**:
  - Template link (URL to Wiki template page)
  - Automatic template attachment to submitted articles
  - Category URLs (JSON array)
  - Automatic category attachment to submitted articles
  - Error tracking for failed template/category attachments

### Contest Status & Lifecycle
- **Status Tracking**:
  - **Current**: Contest is currently active (within date range)
  - **Upcoming**: Contest start date is in the future
  - **Past**: Contest end date has passed
  - **Unknown**: Contest lacks proper date configuration

- **Contest Filtering**:
  - Filter by status (current, upcoming, past)
  - Sort by creation date
  - Search functionality

### Contest Viewing & Details
- **Contest Listing**: Categorized display of all contests
  - Current contests tab
  - Upcoming contests tab
  - Past contests tab
  - Contest cards with metadata
  - Organizer avatars display
  - Submission count badges
  - Status badges

- **Contest Details Page**:
  - Full contest information display
  - Rules and requirements
  - Jury members list
  - Organizers list
  - Submission statistics
  - Leaderboard access
  - Submission form (for active contests)

### Contest Editing & Management
- **Contest Updates** (Creator/Organizer/Admin only):
  - Edit contest name, description, dates
  - Modify jury members and organizers
  - Update scoring parameters (with restrictions)
  - Change article requirements
  - Update template and category links
  - Scoring system changes (restricted if submissions reviewed)

- **Contest Deletion** (Creator/Admin only):
  - Delete contest with all associated submissions
  - Confirmation required

---

## Submission System

### Article Submission
- **Submission Process**:
  - User provides article URL (Wikipedia article link)
  - Automatic article metadata fetching from MediaWiki API
  - Article validation against contest requirements
  - Automatic template attachment (if configured)
  - Automatic category attachment (if configured)
  - Submission creation with pending status

- **Article Metadata Fetching**:
  - Article title extraction from URL
  - Article size (byte count) from latest revision
  - Article author (from latest revision)
  - Article creation date (from oldest revision)
  - MediaWiki page ID
  - Article size at contest start date
  - Expansion bytes calculation (current size - size at submission)

- **Submission Validation**:
  - **Byte Count Validation**: Ensures article meets minimum byte requirement
  - **Reference Count Validation**: Ensures article meets minimum reference requirement
  - **Category Validation**: Ensures article belongs to required categories
  - **Submission Type Validation**: Validates new article vs. expansion
  - **Duplicate Prevention**: Prevents same user from submitting same article to same contest twice

- **Template Enforcement**:
  - Automatic template attachment to article during submission
  - Template presence verification
  - Template attachment tracking (template_added flag)
  - Error handling for template attachment failures

- **Category Enforcement**:
  - Automatic category attachment to article during submission
  - Category presence verification
  - Multiple category support
  - Category attachment tracking (categories_added JSON array)
  - Error tracking for category attachment failures

### Submission Management
- **Submission Viewing**:
  - Users can view their own submissions
  - Jury members can view submissions in their contests
  - Contest creators/organizers can view all submissions in their contests
  - Admins can view all submissions

- **Submission Details**:
  - Article title and link
  - Submission status (pending, accepted, rejected, auto_rejected)
  - Score awarded
  - Submission timestamp
  - Review information (reviewer, review date, comments)
  - Article metadata (size, author, creation date)
  - Template and category attachment status
  - Parameter scores (for multi-parameter scoring)

- **Submission Filtering**:
  - Filter by contest
  - Filter by user
  - Filter by status
  - Filter pending submissions (for jury review)

### Submission Metadata Refresh
- **Bulk Metadata Refresh**:
  - Refresh article metadata for all submissions in a contest
  - Updates expansion bytes (current size - submission size)
  - Preserves original submission-time metadata
  - Available to contest creators/organizers/admins
  - Batch processing with success/failure reporting

---

## Review & Scoring System

### Submission Review Workflow
- **Review Process**:
  - Jury members review pending submissions
  - Review includes status decision (accepted/rejected)
  - Optional review comments/feedback
  - Score assignment based on contest scoring system
  - Automatic user score update

- **Review Permissions**:
  - Jury members can review submissions in their assigned contests
  - Contest creators/organizers can review submissions in their contests
  - Admins can review all submissions
  - One review per submission (prevents re-reviewing)

### Simple Scoring System
- **Fixed Point Scoring**:
  - Configurable points for accepted submissions
  - Configurable points for rejected submissions (usually 0)
  - Manual score override option (within configured range)
  - Score validation (0 to max_score range)

### Multi-Parameter Scoring System
- **Weighted Parameter Scoring**:
  - Multiple scoring parameters (e.g., Quality, Sources, Neutrality, Formatting)
  - Individual parameter scores (0-10 scale)
  - Weighted average calculation
  - Automatic final score calculation
  - Score clamping (min_score to max_score range)
  - Parameter score storage for transparency

- **Parameter Configuration**:
  - Custom parameter names
  - Individual parameter weights (percentages)
  - Parameter descriptions
  - Weight validation (must sum to 100%)
  - Score range configuration (min/max)

### Review Feedback
- **Review Comments**:
  - Optional text feedback from reviewers
  - Stored with review metadata
  - Visible to submission owners
  - Feedback modal display in frontend

- **Review Metadata**:
  - Reviewer identification
  - Review timestamp
  - Review status (accepted/rejected)
  - Score breakdown (for multi-parameter scoring)

---

## Trusted Members System

### Trusted Member Status
- **Purpose**: Control who can create contests
  - Only trusted members and superadmins can create contests
  - Regular users can still submit and participate
  - Prevents spam and ensures contest quality

### Trusted Member Requests
- **Request Process**:
  - Users can request trusted member status
  - Only available to MediaWiki OAuth users
  - Automatic approval for users with â‰¥300 edits
  - Manual review required for users with <300 edits
  - Reason required for users below edit threshold

- **Request Management** (Superadmin only):
  - View all pending requests
  - View request reasons
  - Approve or reject requests
  - Automatic approval based on edit count

### Trusted Member Management
- **Member Management** (Superadmin only):
  - View all trusted members
  - Manually add users as trusted members
  - Remove trusted member status
  - Cannot remove superadmin status

- **Edit Count Integration**:
  - Fetches user edit count from MediaWiki API
  - Automatic approval threshold: 300 edits
  - Edit count display in request interface

---

## Contest Requests System

### Contest Request Submission
- **Request Creation** (Non-privileged users):
  - Users who cannot create contests directly can submit requests
  - Full contest configuration in request
  - Request status: pending, approved, rejected
  - Request tracking and history

### Contest Request Review
- **Request Review** (Superadmin only):
  - View all pending contest requests
  - Review full contest configuration
  - Approve request (creates contest automatically)
  - Reject request (with optional reason)
  - Request metadata (requester, review date, reviewer)

---

## Leaderboards & Statistics

### Contest Leaderboards
- **Leaderboard Display**:
  - Ranked list of participants by score
  - User statistics per contest:
    - Total submissions
    - Total score (marks)
    - Reviewed submissions count
    - Pending submissions count
  - Sequential ranking
  - Pagination support

- **Leaderboard Filtering**:
  - Filter by status (reviewed, pending, all)
  - Filter by minimum marks threshold
  - Sort by marks or submission count
  - Configurable pagination (page, per_page)

- **Contest Statistics**:
  - Total submissions count
  - Total participants count
  - Average score per participant
  - Submission status breakdown

### User Statistics
- **Dashboard Statistics**:
  - Total score across all contests
  - Contest-wise score breakdown
  - Submission statistics by status
  - Acceptance rate calculation
  - Created contests count
  - Jury memberships count

### Submission Statistics
- **Submission Stats Endpoint**:
  - Total submissions count
  - Accepted submissions count
  - Rejected submissions count
  - Pending submissions count
  - Total score
  - Acceptance rate percentage

---

## MediaWiki Integration

### MediaWiki API Integration
- **Article Information Fetching**:
  - Article metadata retrieval
  - Revision history access
  - Article size (byte count) from revisions
  - Article author from latest revision
  - Article creation date from oldest revision
  - Page ID retrieval
  - Reference count calculation (footnotes + external links)

- **Article Editing** (via OAuth):
  - Template attachment to articles
  - Category attachment to articles
  - Edit tracking and error handling
  - OAuth token management for authenticated edits

### Template & Category Management
- **Template Enforcement**:
  - Template link validation
  - Template name extraction from URL
  - Template presence checking
  - Automatic template prepending to article
  - Template attachment tracking

- **Category Enforcement**:
  - Category URL validation
  - Category name extraction from URLs
  - Category presence checking
  - Automatic category appending to article
  - Multiple category support
  - Category attachment tracking

### Article Validation
- **Byte Count Validation**:
  - Fetches current article size from MediaWiki API
  - Compares against contest minimum requirement
  - Error messages for undersized articles

- **Reference Count Validation**:
  - Counts footnotes (<ref> tags) in article
  - Counts external links (URLs) in article
  - Compares against contest minimum requirement
  - Error messages for insufficient references

- **Category Validation**:
  - Checks if article belongs to required categories
  - Validates category presence on article
  - Error messages for missing categories

---

## Frontend Features

### User Interface Components
- **Home Page**: Landing page with login/registration options
- **Contest Listing Page**: Categorized contest display with filtering
- **Contest Details Page**: Full contest information and submission interface
- **Dashboard**: User statistics and submission overview
- **Profile Page**: User profile viewing and editing
- **Jury Dashboard**: Interface for reviewing submissions
- **Trusted Members Page**: Management interface for trusted members (superadmin)
- **Leaderboard Page**: Contest leaderboard display

### UI Components
- **AlertContainer**: Global alert notification system
- **ArticlePreviewModal**: Preview Wikipedia articles before submission
- **ContestLeaderboard**: Leaderboard display component
- **ContestModal**: Contest details modal
- **CreateContestModal**: Contest creation form
- **JuryDashboard**: Submission review interface
- **JuryFeedbackModal**: Display review feedback to users
- **RequestContestModal**: Contest request submission form
- **RequestTrustedMemberModal**: Trusted member request form
- **ReviewSubmissionModal**: Submission review form for jury
- **SubmitArticleModal**: Article submission form

### Frontend Features
- **Responsive Design**: Mobile, tablet, and desktop optimization
- **Real-time Updates**: Dynamic content loading
- **Form Validation**: Client-side validation with error messages
- **Loading States**: Visual feedback during async operations
- **Error Handling**: User-friendly error messages
- **Navigation Guards**: Protected routes with authentication checks
- **OAuth Integration**: Seamless Wikimedia OAuth flow
- **Modal Dialogs**: Context-aware forms and confirmations

### State Management
- **Vue 3 Composition API**: Modern reactive state management
- **Store Pattern**: Centralized state for user, contests, submissions
- **Authentication State**: Persistent login state
- **Contest Filtering**: Client-side contest categorization

---

## Security & Permissions

### Authentication Security
- **JWT Tokens**: Secure token-based authentication
- **HTTP-Only Cookies**: Secure token storage (prevents XSS)
- **CSRF Protection**: Cross-site request forgery prevention
- **Password Hashing**: bcrypt password hashing with salt
- **Session Management**: Secure session handling

### Authorization & Access Control
- **Role-Based Access Control (RBAC)**:
  - User role hierarchy (user, admin, superadmin)
  - Role-based permission checks
  - Contextual permissions (contest creator, jury, organizer)

- **Permission Checks**:
  - Contest creation: Trusted members and superadmins only
  - Contest editing: Creator, organizers, and admins
  - Submission review: Jury members, organizers, and admins
  - Submission viewing: Owner, jury, organizers, and admins
  - Trusted member management: Superadmin only
  - Contest request review: Superadmin only

- **Middleware Protection**:
  - Authentication middleware (require_auth)
  - Role-based middleware (require_role)
  - Submission permission middleware (require_submission_permission)
  - Automatic permission validation

### Data Validation
- **Input Validation**: Server-side validation for all inputs
- **SQL Injection Prevention**: SQLAlchemy ORM with parameterized queries
- **XSS Prevention**: Output escaping and sanitization
- **CSRF Tokens**: Token-based CSRF protection

---

## Database & Data Models

### User Model
- **Core Fields**:
  - id (Primary Key)
  - username (Unique, indexed)
  - email (Unique, indexed)
  - password (Hashed)
  - role (user, admin, superadmin)
  - score (Total accumulated score)
  - created_at (Timestamp)

- **OAuth Fields**:
  - oauth_token (MediaWiki OAuth token)
  - oauth_token_secret (MediaWiki OAuth secret)

- **Trusted Member Fields**:
  - is_trusted_member (Boolean)
  - trusted_member_request (Boolean)
  - trusted_member_request_reason (Text)

- **Relationships**:
  - created_contests (One-to-many)
  - submissions (One-to-many)
  - reviewed_submissions (One-to-many)
  - contest_requests (One-to-many)

### Contest Model
- **Core Fields**:
  - id (Primary Key)
  - name (String)
  - project_name (String)
  - created_by (Foreign Key to User.username)
  - description (Text)
  - start_date (Date)
  - end_date (Date)
  - created_at (Timestamp)

- **Scoring Fields**:
  - marks_setting_accepted (Integer)
  - marks_setting_rejected (Integer)
  - scoring_parameters (JSON Text)
  - allowed_submission_type (String: new, expansion, both)

- **Requirements Fields**:
  - min_byte_count (Integer)
  - min_reference_count (Integer)
  - categories (JSON Text)
  - template_link (Text)

- **People Fields**:
  - jury_members (Text, comma-separated)
  - organizers (Text, comma-separated)

- **Relationships**:
  - submissions (One-to-many)
  - creator (Many-to-one to User)

### Submission Model
- **Core Fields**:
  - id (Primary Key)
  - user_id (Foreign Key to User)
  - contest_id (Foreign Key to Contest)
  - article_title (String)
  - article_link (String)
  - status (String: pending, accepted, rejected, auto_rejected)
  - score (Integer)
  - submitted_at (Timestamp)

- **Article Metadata Fields**:
  - article_author (String)
  - article_created_at (DateTime)
  - article_word_count (Integer)
  - article_page_id (String)
  - article_size_at_start (Integer)
  - article_expansion_bytes (Integer)

- **Enforcement Fields**:
  - template_added (Boolean)
  - categories_added (JSON Text)
  - category_error (Text)

- **Review Fields**:
  - reviewed_by (Foreign Key to User)
  - reviewed_at (DateTime)
  - review_comment (Text)
  - parameter_scores (JSON Text)

- **Relationships**:
  - submitter (Many-to-one to User)
  - reviewer (Many-to-one to User)
  - contest (Many-to-one to Contest)

- **Constraints**:
  - Unique constraint: (user_id, contest_id, article_link)

### ContestRequest Model
- **Core Fields**:
  - id (Primary Key)
  - user_id (Foreign Key to User)
  - name, project_name, description
  - start_date, end_date
  - rules (JSON Text)
  - jury_members, organizers (Text)
  - min_byte_count, min_reference_count
  - categories (JSON Text)
  - template_link (Text)
  - scoring_parameters (JSON Text)
  - allowed_submission_type
  - marks_setting_accepted, marks_setting_rejected
  - status (String: pending, approved, rejected)
  - reviewed_by (Foreign Key to User)
  - reviewed_at (DateTime)
  - rejection_reason (Text)
  - created_at (Timestamp)

- **Relationships**:
  - requester (Many-to-one to User)
  - reviewer (Many-to-one to User)

### Database Features
- **Migrations**: Alembic for version-controlled schema management
- **Relationships**: SQLAlchemy ORM relationships with lazy loading
- **Indexes**: Optimized queries with indexed fields
- **Constraints**: Unique constraints and foreign keys
- **Transactions**: ACID-compliant database transactions

---

## Additional Features

### Utility Scripts
- **Database Initialization**: Scripts for database setup
- **Metadata Backfilling**: Scripts to backfill article metadata
- **Article Metadata Fetching**: Standalone scripts for testing
- **Migration Management**: Alembic migration helpers

### Deployment Features
- **Toolforge Support**: Wikimedia Toolforge deployment configuration
- **Production Build**: Optimized frontend build process
- **Environment Configuration**: Flexible environment variable configuration
- **Logging**: Application logging system

### API Features
- **RESTful API**: Clean REST API design
- **JSON Responses**: Consistent JSON response format
- **Error Handling**: Comprehensive error handling
- **Health Checks**: API health check endpoint
- **Cookie Management**: Secure cookie handling

---

## Summary

The WikiContest platform is a comprehensive event management system specifically designed for Wikipedia article editing contests. It provides:

- **Complete Authentication System**: Email/password and Wikimedia OAuth
- **Flexible Contest Management**: Creation, configuration, and lifecycle management
- **Robust Submission System**: Article submission with automatic validation and enforcement
- **Advanced Scoring Systems**: Simple and multi-parameter scoring options
- **Comprehensive Review Workflow**: Jury-based review with feedback
- **Trusted Member System**: Controlled contest creation with edit count integration
- **Rich Statistics & Leaderboards**: Detailed analytics and rankings
- **MediaWiki Integration**: Deep integration with Wikipedia infrastructure
- **Modern Frontend**: Responsive Vue.js 3 application with excellent UX
- **Security & Permissions**: Role-based access control with comprehensive security

The platform is production-ready and designed for deployment on Wikimedia Toolforge, making it ideal for Wikipedia community events and edit-a-thons.

